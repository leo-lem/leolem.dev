---
import BaseLayout from "../../layout/BaseLayout.astro";
import SubscribePanel from "../../components/SubscribePanel.astro";
import FeaturedArticle from "../../components/FeaturedArticle.astro";
import ArticleRow from "../../components/ArticleRow.astro";
import { getBlog, getFeaturedBlog } from "../../content/blog";

const featured = await getFeaturedBlog();
const articles = (await getBlog()).filter(
  ({ data: { featured } }) => !featured
);
---

<BaseLayout
  title="My Blog"
  description="Welcome to my blog. I write about building software, exploring systems, and learning in public. Expect posts on Swift, CI/CD, architecture, side projects, and personal reflections from whatever I'm working through."
>
  <section class="container">
    {
      featured && (
        <FeaturedArticle
          article={featured}
          class="responsive card card-elevated text-center"
        />
      )
    }
  </section>

  <SubscribePanel
    label="Get notified via"
    class="container-narrow stack-sm justify-center p-2 scroll-mt-32"
  />

  <ul class="container-wide stack">
    {
      articles.map((article, idx) => (
        <li>
          <ArticleRow article={article} class={idx < 3 ? "eager" : "lazy"} />
        </li>
      ))
    }
  </ul>
</BaseLayout>
