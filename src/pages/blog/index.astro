---
import { BaseLayout } from "../../layout";
import { SubscribePanel, ArticleRow, FeaturedArticle } from "../../components";
import { getBlog } from "../../content";
import { onlyFeatured, onlyNonFeatured } from "../../lib";

const blog = await getBlog();
const featured = blog.find(onlyFeatured);
const articles = blog.filter(onlyNonFeatured);
---

<BaseLayout
  title="My Blog"
  description="Welcome to my blog. I write about building software, exploring systems, and learning in public. Expect posts on Swift, CI/CD, architecture, side projects, and personal reflections from whatever I'm working through."
>
  <section class="container">
    {
      featured && (
        <FeaturedArticle
          article={featured}
          class="responsive card card-elevated text-center"
        />
      )
    }
  </section>

  <SubscribePanel
    label="Get notified via"
    class="container-narrow stack-sm justify-center p-2 scroll-mt-32"
  />

  <ul class="container-wide stack">
    {
      articles.map((article, idx) => (
        <li>
          <ArticleRow article={article} class={idx < 3 ? "eager" : "lazy"} />
        </li>
      ))
    }
  </ul>
</BaseLayout>
